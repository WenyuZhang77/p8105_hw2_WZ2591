p8105\_hw2\_WZ2591
================
Wenyu Zhang
10/5/2021

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──

    ## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
    ## ✓ tibble  3.1.4     ✓ dplyr   1.0.7
    ## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
    ## ✓ readr   2.0.1     ✓ forcats 0.5.1

    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(readxl)
```

# Problem 1

## Read and clean the Mr. Trash Wheel sheet:

1.  specify the sheet in the Excel file and to omit non-data entries
    (rows with notes / figures; columns containing notes) using
    arguments in read\_excel

2.  use reasonable variable names

3.  omit rows that do not include dumpster-specific data

4.  round the number of sports balls to the nearest integer

``` r
mr_trash_wheel = 
  read_excel("data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", range = "A2:N535") %>% 
  janitor::clean_names() %>% 
  rename(weight = weight_tons, volume = volume_cubic_yards) %>% 
  filter(!is.na(dumpster)) %>%
  mutate(sports_balls = as.integer(round(sports_balls)))
```

## Read and clean precipitation data for 2018 and 2019:

``` r
trash_wheel_precipitation_2018 = 
  read_excel("data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = 7, range = "A2:B14") %>%
  janitor::clean_names() %>%
  rename(total_precipitation = total) %>%
  filter(!is.na(total_precipitation)) %>% 
  mutate(year = 2018, 
         month = month.name[month]) %>%
  relocate(year)

trash_wheel_precipitation_2018
```

    ## # A tibble: 12 × 3
    ##     year month     total_precipitation
    ##    <dbl> <chr>                   <dbl>
    ##  1  2018 January                  0.94
    ##  2  2018 February                 4.8 
    ##  3  2018 March                    2.69
    ##  4  2018 April                    4.69
    ##  5  2018 May                      9.27
    ##  6  2018 June                     4.77
    ##  7  2018 July                    10.2 
    ##  8  2018 August                   6.45
    ##  9  2018 September               10.5 
    ## 10  2018 October                  2.12
    ## 11  2018 November                 7.82
    ## 12  2018 December                 6.11

``` r
trash_wheel_precipitation_2019 = 
  read_excel("data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = 6, range = "A2:B14") %>%
  janitor::clean_names() %>%
  rename(total_precipitation = total) %>%
  drop_na(total_precipitation) %>% 
  mutate(year = 2019, 
         month = month.name[month]) %>% 
  relocate(year)

trash_wheel_precipitation_2019
```

    ## # A tibble: 12 × 3
    ##     year month     total_precipitation
    ##    <dbl> <chr>                   <dbl>
    ##  1  2019 January                  3.1 
    ##  2  2019 February                 3.64
    ##  3  2019 March                    4.47
    ##  4  2019 April                    1.46
    ##  5  2019 May                      3.58
    ##  6  2019 June                     0.42
    ##  7  2019 July                     3.85
    ##  8  2019 August                   2.39
    ##  9  2019 September                0.16
    ## 10  2019 October                  5.45
    ## 11  2019 November                 1.86
    ## 12  2019 December                 3.57

``` r
# Combine precipitation datasets for 2018 and 2019
trash_wheel_precipitation_2018_2019 = 
  bind_rows(trash_wheel_precipitation_2018, trash_wheel_precipitation_2019)

trash_wheel_precipitation_2018_2019
```

    ## # A tibble: 24 × 3
    ##     year month     total_precipitation
    ##    <dbl> <chr>                   <dbl>
    ##  1  2018 January                  0.94
    ##  2  2018 February                 4.8 
    ##  3  2018 March                    2.69
    ##  4  2018 April                    4.69
    ##  5  2018 May                      9.27
    ##  6  2018 June                     4.77
    ##  7  2018 July                    10.2 
    ##  8  2018 August                   6.45
    ##  9  2018 September               10.5 
    ## 10  2018 October                  2.12
    ## # … with 14 more rows

## Write a paragraph about these data

For “mr\_trash\_wheel\_data”, there are 454 rows and 14 columns with 13
variables: dumpster, month, year, weight, volume, plastic\_bottles,
polystyrene, cigarette\_butts, glass\_bottles, grocery\_bags,
chip\_bags, sports\_balls and homes\_powered.

``` r
# Describe mr_trash_wheel data
skimr::skim(mr_trash_wheel)
```

|                                                  |                  |
|:-------------------------------------------------|:-----------------|
| Name                                             | mr\_trash\_wheel |
| Number of rows                                   | 454              |
| Number of columns                                | 14               |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_   |                  |
| Column type frequency:                           |                  |
| character                                        | 2                |
| numeric                                          | 11               |
| POSIXct                                          | 1                |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ |                  |
| Group variables                                  | None             |

Data summary

**Variable type: character**

| skim\_variable | n\_missing | complete\_rate | min | max | empty | n\_unique | whitespace |
|:---------------|-----------:|---------------:|----:|----:|------:|----------:|-----------:|
| dumpster       |          0 |              1 |   1 |  11 |     0 |       454 |          0 |
| month          |          1 |              1 |   3 |   9 |     0 |        13 |          0 |

**Variable type: numeric**

| skim\_variable   | n\_missing | complete\_rate |     mean |        sd |      p0 |     p25 |      p50 |      p75 |       p100 | hist  |
|:-----------------|-----------:|---------------:|---------:|----------:|--------:|--------:|---------:|---------:|-----------:|:------|
| year             |          1 |              1 |  2017.26 |      1.95 | 2014.00 | 2015.00 |  2018.00 |  2019.00 |     2021.0 | ▆▃▇▃▃ |
| weight           |          0 |              1 |     6.39 |     67.89 |    0.78 |    2.72 |     3.19 |     3.68 |     1449.7 | ▇▁▁▁▁ |
| volume           |          0 |              1 |    30.76 |    326.96 |    7.00 |   15.00 |    15.00 |    15.00 |     6982.0 | ▇▁▁▁▁ |
| plastic\_bottles |          0 |              1 |  3789.49 |  40295.85 |  210.00 |  980.00 |  1850.00 |  2640.00 |   860215.0 | ▇▁▁▁▁ |
| polystyrene      |          0 |              1 |  3833.38 |  40765.80 |  210.00 |  950.00 |  1650.00 |  2730.00 |   870177.0 | ▇▁▁▁▁ |
| cigarette\_butts |          0 |              1 | 48935.33 | 521172.52 |  980.00 | 5000.00 | 11000.00 | 32750.00 | 11108320.0 | ▇▁▁▁▁ |
| glass\_bottles   |          0 |              1 |    44.81 |    476.61 |    0.00 |    9.25 |    18.00 |    32.00 |    10171.0 | ▇▁▁▁▁ |
| grocery\_bags    |          0 |              1 |  2201.50 |  23404.23 |   50.00 |  426.25 |   820.00 |  1627.50 |   499448.0 | ▇▁▁▁▁ |
| chip\_bags       |          0 |              1 |  3107.37 |  33017.93 |  180.00 |  802.50 |  1333.50 |  2150.00 |   704792.0 | ▇▁▁▁▁ |
| sports\_balls    |          0 |              1 |    23.43 |    249.06 |    0.00 |    5.00 |     9.00 |    16.00 |     5315.0 | ▇▁▁▁▁ |
| homes\_powered   |          0 |              1 |    90.44 |    961.64 |    0.00 |   38.88 |    51.17 |    58.79 |    20530.0 | ▇▁▁▁▁ |

**Variable type: POSIXct**

| skim\_variable | n\_missing | complete\_rate | min        | max        | median     | n\_unique |
|:---------------|-----------:|---------------:|:-----------|:-----------|:-----------|----------:|
| date           |          1 |              1 | 1900-01-20 | 2021-01-04 | 2018-02-05 |       275 |

``` r
nrow(mr_trash_wheel)
```

    ## [1] 454

``` r
ncol(mr_trash_wheel)
```

    ## [1] 14

For “trash\_wheel\_precipitation\_2018\_2019” data, there are 24 rows
and 3 columns with 3 variables: month, year and total\_precipitation

``` r
# Describe trash_wheel_precipitation_2018_2019 data
skimr::skim(trash_wheel_precipitation_2018_2019)
```

|                                                  |                              |
|:-------------------------------------------------|:-----------------------------|
| Name                                             | trash\_wheel\_precipitation… |
| Number of rows                                   | 24                           |
| Number of columns                                | 3                            |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_   |                              |
| Column type frequency:                           |                              |
| character                                        | 1                            |
| numeric                                          | 2                            |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ |                              |
| Group variables                                  | None                         |

Data summary

**Variable type: character**

| skim\_variable | n\_missing | complete\_rate | min | max | empty | n\_unique | whitespace |
|:---------------|-----------:|---------------:|----:|----:|------:|----------:|-----------:|
| month          |          0 |              1 |   3 |   9 |     0 |        12 |          0 |

**Variable type: numeric**

| skim\_variable       | n\_missing | complete\_rate |    mean |   sd |      p0 |     p25 |     p50 |     p75 |    p100 | hist  |
|:---------------------|-----------:|---------------:|--------:|-----:|--------:|--------:|--------:|--------:|--------:|:------|
| year                 |          0 |              1 | 2018.50 | 0.51 | 2018.00 | 2018.00 | 2018.50 | 2019.00 | 2019.00 | ▇▁▁▁▇ |
| total\_precipitation |          0 |              1 |    4.34 | 2.88 |    0.16 |    2.32 |    3.74 |    5.62 |   10.47 | ▇▇▇▂▃ |

``` r
nrow(trash_wheel_precipitation_2018_2019)
```

    ## [1] 24

``` r
ncol(trash_wheel_precipitation_2018_2019)
```

    ## [1] 3

For available data, what was the total precipitation in 2018? What was
the median number of sports balls in a dumpster in 2019?

``` r
# The total precipitation in 2018
sum(pull(trash_wheel_precipitation_2018,total_precipitation))
```

    ## [1] 70.33

``` r
# The median number of sports balls in a dumpster in 2019
balls_in_2019 = filter(mr_trash_wheel, year == "2019")
median(pull(balls_in_2019, sports_balls))
```

    ## [1] 9

The total precipitation in 201 is 70.33, and the median number of sports
balls in a dumpster in 2019 is 9

# Problem 2

\#\#First, clean the data in pols-month.csv.

1.  Use separate() to break up the variable mon into integer variables
    year, month, and day

2.  replace month number with month name

3.  create a president variable taking values gop and dem, and remove
    prez\_dem and prez\_gop

4.  remove the day variable.

``` r
pols_month_df = 
  read_csv("data/fivethirtyeight_datasets/pols-month.csv") %>%   
  janitor::clean_names() %>% 
  separate(mon, into = c("year", "month", "day")) %>% 
  mutate(month = month.name[as.numeric(month)], 
         year = as.numeric(year)) %>% 
  mutate(president = if_else(prez_gop == 0, "democreatic", "republican")) %>%
  select(-prez_dem, -prez_gop, -day)
```

    ## Rows: 822 Columns: 9

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

## Second, clean the data in snp.csv using a similar process to the above.

For consistency across datasets, arrange according to year and month,
and organize so that year and month are the leading columns.

``` r
snp_df = 
  read_csv("data/fivethirtyeight_datasets/snp.csv") %>% 
  janitor::clean_names() %>% 
  separate(date, into = c("month", "day", "year")) %>% 
  mutate(month = month.name[as.numeric(month)], 
         year = as.numeric(year)) %>%
  select(year, month, day, close) %>%
  
  
  mutate(year = ifelse(year > 90, year + 1900, year + 2000)) %>% 
  
  
  arrange(year, month)
```

    ## Rows: 787 Columns: 2

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

## Third, tidy the unemployment data so that it can be merged with the previous datasets.

This process will involve switching from “wide” to “long” format;
ensuring that key variables have the same name; and ensuring that key
variables take the same values.

``` r
unemployment_df = 
  read_csv("data/fivethirtyeight_datasets/unemployment.csv") %>%
  pivot_longer(
    Jan:Dec,
    names_to = "month",
    values_to = "unemployment") %>%
  mutate(month = month.name[match(month,month.abb)])
```

    ## Rows: 68 Columns: 13

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Join the datasets by merging snp into pols, and merging unemployment
into the result.

``` r
pols_snp = left_join(pols_month_df, snp_df) 
```

    ## Joining, by = c("year", "month")
